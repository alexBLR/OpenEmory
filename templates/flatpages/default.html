{% extends "site_base.html" %}
{% load flatpages %}

{% block page-subtitle %}{{ block.super }} | {{ flatpage.title }}{% endblock %}

{% block content %}
{# NOTE: template based on article view, may need to change based on final design #}
<div class="inner">

  {# left sidebar - link all flat pages #}
  <div class="left">
    <div class="top">
      <h1 class="shadow">Related content</h1>
    </div>
    <div class="bottom">
      {# about pages #}
      <h2>{% if sitepages.about.url == flatpage.url %}{{ sitepages.about.title }} 
      {% else %}<a href="{{ sitepages.about.url }}">{{ sitepages.about.title }}</a>{% endif %}</h2> 
      {% get_flatpages sitepages.about.url as about_pages %}
      <ul>
      {% for page in about_pages %}
        {% if page.url != sitepages.about.url %} {# don't re-display about #}
          <li>
          {% if page.url == flatpage.url %}{{ page.title }}{# don't link the current page #}
          {% else %}<a href="{{ page.url }}">{{ page.title }}</a>{% endif %}
          </li>
         {% endif %}
      {% endfor %}
      </ul>

      {# how-to pages #}
      <h2>{% if sitepages.howto.url == flatpage.url %}{{ sitepages.howto.title }} 
      {% else %}<a href="{{ sitepages.howto.url }}">{{ sitepages.howto.title }}</a>{% endif %}</h2> 
      {% get_flatpages sitepages.howto.url as howto_pages %}
      <ul>
      {% for page in howto_pages %}
        {% if page.url != sitepages.howto.url %}
          <li>
          {% if page.url == flatpage.url %}{{ page.title }}{# don't link the current page #}
          {% else %}<a href="{{ page.url }}">{{ page.title }}</a>{% endif %}
          </li>
        {% endif %}
      {% endfor %}
      </ul>

      {% if perms.flatpages.change_flatpage or perms.flatpages.add_flatpage %}
      <hr/>
        {% if perms.flatpages.change_flatpage %}
          <p><a href="{% url admin:flatpages_flatpage_change flatpage.id %}">edit this page</a></p>
        {% endif %}
        {% if perms.flatpages.add_flatpage %}
          <p><a href="{% url admin:flatpages_flatpage_add %}">add a page</a></p>
        {% endif %}
      {% endif %}
    </div>
  </div>

<div class="right">
  <div class="top">
    <div class="left">
      <h1 class="shadow">{{ flatpage.title }}</h1>
      {{ flatpage.content }}
     </div>
  </div>

</div>

</div>
{% endblock %}
